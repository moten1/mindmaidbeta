{"ast":null,"code":"import React,{useState,useRef}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API_URL=process.env.REACT_APP_API_URL||'http://localhost:5000';export default function EmotionAnalysis(){const[analyzing,setAnalyzing]=useState(false);const[result,setResult]=useState(null);const[image,setImage]=useState(null);const videoRef=useRef(null);const[stream,setStream]=useState(null);const startCamera=async()=>{try{const mediaStream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}});videoRef.current.srcObject=mediaStream;setStream(mediaStream);}catch(error){alert('Camera access denied. Please allow camera access.');}};const capturePhoto=()=>{const canvas=document.createElement('canvas');canvas.width=videoRef.current.videoWidth;canvas.height=videoRef.current.videoHeight;canvas.getContext('2d').drawImage(videoRef.current,0,0);canvas.toBlob(async blob=>{setImage(URL.createObjectURL(blob));await analyzeEmotion(blob);},'image/jpeg');};const analyzeEmotion=async imageBlob=>{setAnalyzing(true);try{const formData=new FormData();formData.append('image',imageBlob,'selfie.jpg');const response=await axios.post(\"\".concat(API_URL,\"/api/emotion/analyze\"),formData,{headers:{'Content-Type':'multipart/form-data'}});setResult(response.data);}catch(error){console.error('Emotion analysis error:',error);alert('Failed to analyze emotion. Please try again.');}finally{setAnalyzing(false);if(stream){stream.getTracks().forEach(track=>track.stop());setStream(null);}}};const resetAnalysis=()=>{setResult(null);setImage(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold text-gray-800\",children:\"Emotion Analysis\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg text-gray-600\",children:\"Let AI analyze your facial expression to understand your mood and get personalized recommendations!\"}),!result&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-semibold mb-4\",children:\"Capture Your Expression\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center gap-4\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,playsInline:true,className:\"w-full max-w-md rounded-lg border-2 border-gray-300\"}),!stream?/*#__PURE__*/_jsx(\"button\",{onClick:startCamera,className:\"bg-yellow-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-yellow-500 transition-colors\",children:\"\\uD83D\\uDCF8 Start Camera\"}):/*#__PURE__*/_jsx(\"button\",{onClick:capturePhoto,disabled:analyzing,className:\"bg-yellow-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-yellow-500 transition-colors disabled:bg-gray-300\",children:analyzing?'Analyzing...':'âœ¨ Capture & Analyze'})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-4 text-center\",children:\"Your image is processed securely and not stored.\"})]}),result&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-semibold mb-4\",children:\"Your Emotion Analysis\"}),image&&/*#__PURE__*/_jsx(\"img\",{src:image,alt:\"Your selfie\",className:\"w-full max-w-md mx-auto rounded-lg mb-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-yellow-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:\"Detected Mood:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xl text-yellow-700\",children:result.dominantEmotion||'Analyzing...'})]}),result.emotions&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800 mb-2\",children:\"Emotion Breakdown:\"}),Object.entries(result.emotions).map(_ref=>{let[emotion,score]=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"capitalize\",children:emotion}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-600\",children:[(score*100).toFixed(1),\"%\"]})]},emotion);})]}),result.recommendation&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-blue-50 rounded-lg\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800 mb-2\",children:\"AI Recommendation:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:result.recommendation})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:resetAnalysis,className:\"mt-4 w-full bg-gray-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-gray-500 transition-colors\",children:\"Try Again\"})]})})]});}","map":{"version":3,"names":["React","useState","useRef","axios","jsx","_jsx","jsxs","_jsxs","API_URL","process","env","REACT_APP_API_URL","EmotionAnalysis","analyzing","setAnalyzing","result","setResult","image","setImage","videoRef","stream","setStream","startCamera","mediaStream","navigator","mediaDevices","getUserMedia","video","facingMode","current","srcObject","error","alert","capturePhoto","canvas","document","createElement","width","videoWidth","height","videoHeight","getContext","drawImage","toBlob","blob","URL","createObjectURL","analyzeEmotion","imageBlob","formData","FormData","append","response","post","concat","headers","data","console","getTracks","forEach","track","stop","resetAnalysis","className","children","ref","autoPlay","playsInline","onClick","disabled","src","alt","dominantEmotion","emotions","Object","entries","map","_ref","emotion","score","toFixed","recommendation"],"sources":["C:/Users/Kashif/Desktop/MindMaidbetaFresh/frontend/src/Component/EmotionAnalysis.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:5000';\r\n\r\nexport default function EmotionAnalysis() {\r\n  const [analyzing, setAnalyzing] = useState(false);\r\n  const [result, setResult] = useState(null);\r\n  const [image, setImage] = useState(null);\r\n  const videoRef = useRef(null);\r\n  const [stream, setStream] = useState(null);\r\n\r\n  const startCamera = async () => {\r\n    try {\r\n      const mediaStream = await navigator.mediaDevices.getUserMedia({ \r\n        video: { facingMode: 'user' } \r\n      });\r\n      videoRef.current.srcObject = mediaStream;\r\n      setStream(mediaStream);\r\n    } catch (error) {\r\n      alert('Camera access denied. Please allow camera access.');\r\n    }\r\n  };\r\n\r\n  const capturePhoto = () => {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = videoRef.current.videoWidth;\r\n    canvas.height = videoRef.current.videoHeight;\r\n    canvas.getContext('2d').drawImage(videoRef.current, 0, 0);\r\n    \r\n    canvas.toBlob(async (blob) => {\r\n      setImage(URL.createObjectURL(blob));\r\n      await analyzeEmotion(blob);\r\n    }, 'image/jpeg');\r\n  };\r\n\r\n  const analyzeEmotion = async (imageBlob) => {\r\n    setAnalyzing(true);\r\n    try {\r\n      const formData = new FormData();\r\n      formData.append('image', imageBlob, 'selfie.jpg');\r\n\r\n      const response = await axios.post(`${API_URL}/api/emotion/analyze`, formData, {\r\n        headers: { 'Content-Type': 'multipart/form-data' }\r\n      });\r\n\r\n      setResult(response.data);\r\n    } catch (error) {\r\n      console.error('Emotion analysis error:', error);\r\n      alert('Failed to analyze emotion. Please try again.');\r\n    } finally {\r\n      setAnalyzing(false);\r\n      if (stream) {\r\n        stream.getTracks().forEach(track => track.stop());\r\n        setStream(null);\r\n      }\r\n    }\r\n  };\r\n\r\n  const resetAnalysis = () => {\r\n    setResult(null);\r\n    setImage(null);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <h1 className=\"text-4xl font-extrabold text-gray-800\">Emotion Analysis</h1>\r\n      \r\n      <p className=\"text-lg text-gray-600\">\r\n        Let AI analyze your facial expression to understand your mood and get personalized recommendations!\r\n      </p>\r\n\r\n      {!result && (\r\n        <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n          <h2 className=\"text-2xl font-semibold mb-4\">Capture Your Expression</h2>\r\n          \r\n          <div className=\"flex flex-col items-center gap-4\">\r\n            <video \r\n              ref={videoRef} \r\n              autoPlay \r\n              playsInline\r\n              className=\"w-full max-w-md rounded-lg border-2 border-gray-300\"\r\n            />\r\n            \r\n            {!stream ? (\r\n              <button\r\n                onClick={startCamera}\r\n                className=\"bg-yellow-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-yellow-500 transition-colors\"\r\n              >\r\n                ðŸ“¸ Start Camera\r\n              </button>\r\n            ) : (\r\n              <button\r\n                onClick={capturePhoto}\r\n                disabled={analyzing}\r\n                className=\"bg-yellow-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-yellow-500 transition-colors disabled:bg-gray-300\"\r\n              >\r\n                {analyzing ? 'Analyzing...' : 'âœ¨ Capture & Analyze'}\r\n              </button>\r\n            )}\r\n          </div>\r\n\r\n          <p className=\"text-sm text-gray-500 mt-4 text-center\">\r\n            Your image is processed securely and not stored.\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {result && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"bg-white p-6 rounded-lg shadow-md\">\r\n            <h3 className=\"text-2xl font-semibold mb-4\">Your Emotion Analysis</h3>\r\n            \r\n            {image && (\r\n              <img src={image} alt=\"Your selfie\" className=\"w-full max-w-md mx-auto rounded-lg mb-4\" />\r\n            )}\r\n\r\n            <div className=\"space-y-3\">\r\n              <div className=\"p-4 bg-yellow-50 rounded-lg\">\r\n                <p className=\"font-semibold text-gray-800\">Detected Mood:</p>\r\n                <p className=\"text-xl text-yellow-700\">{result.dominantEmotion || 'Analyzing...'}</p>\r\n              </div>\r\n\r\n              {result.emotions && (\r\n                <div className=\"p-4 bg-gray-50 rounded-lg\">\r\n                  <p className=\"font-semibold text-gray-800 mb-2\">Emotion Breakdown:</p>\r\n                  {Object.entries(result.emotions).map(([emotion, score]) => (\r\n                    <div key={emotion} className=\"flex justify-between items-center mb-1\">\r\n                      <span className=\"capitalize\">{emotion}</span>\r\n                      <span className=\"text-gray-600\">{(score * 100).toFixed(1)}%</span>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {result.recommendation && (\r\n                <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                  <p className=\"font-semibold text-gray-800 mb-2\">AI Recommendation:</p>\r\n                  <p className=\"text-gray-700\">{result.recommendation}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <button\r\n              onClick={resetAnalysis}\r\n              className=\"mt-4 w-full bg-gray-400 text-white font-semibold px-6 py-3 rounded-md hover:bg-gray-500 transition-colors\"\r\n            >\r\n              Try Again\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}